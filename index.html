<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rahul Khanjire Sir - Official Chat</title>
    <style>
        :root {
            --wa-green: #00a884;
            --wa-dark: #111b21;
            --wa-header: #202c33;
            --wa-chat-bg: #0b141a;
            --wa-msg-in: #202c33;
            --wa-msg-out: #005c4b;
            --text-primary: #e9edef;
            --text-secondary: #8696a0;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', Helvetica, Arial, sans-serif; }
        
        body { 
            margin: 0; padding: 0; 
            background-color: var(--wa-dark); 
            color: var(--text-primary); 
            height: 100vh; display: flex; flex-direction: column; 
            overflow: hidden;
        }

        /* HEADER */
        .header {
            display: flex; align-items: center; padding: 10px 16px;
            background-color: var(--wa-header); border-bottom: 1px solid #333;
            height: 60px; flex-shrink: 0; cursor: pointer;
        }
        .back-btn { margin-right: 10px; font-size: 20px; color: var(--text-primary); }
        .avatar {
            width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 12px;
            background: #ccc; /* Fallback color */
        }
        .info { flex: 1; }
        .name { font-size: 16px; font-weight: 500; display: flex; align-items: center; gap: 5px; }
        .verified-tick { color: #00a884; font-size: 14px; } /* Green Tick */
        .status { font-size: 12px; color: var(--text-secondary); }
        
        .header-icons { display: flex; gap: 20px; color: var(--text-primary); font-size: 20px; }

        /* API SETUP PANEL */
        #apiPanel {
            position: absolute; top: 60px; right: 10px; width: 300px;
            background: #2a3942; padding: 15px; border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5); z-index: 100;
            display: none; border: 1px solid #444;
        }
        #apiPanel.active { display: block; }
        #apiKeyInput {
            width: 100%; padding: 10px; background: #111b21; border: 1px solid #555;
            color: white; border-radius: 5px; margin-top: 5px; font-family: monospace;
        }
        .save-btn {
            width: 100%; padding: 10px; margin-top: 10px; background: var(--wa-green);
            color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;
        }

        /* CHAT AREA */
        .chat-container {
            flex: 1; overflow-y: auto; padding: 20px;
            background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
            background-repeat: repeat; background-size: 400px;
            display: flex; flex-direction: column; gap: 10px;
        }

        .msg {
            max-width: 80%; padding: 8px 12px; border-radius: 8px;
            font-size: 14.2px; line-height: 19px; position: relative;
            box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
        }
        .msg-in { 
            align-self: flex-start; background: var(--wa-msg-in); 
            border-top-left-radius: 0; 
        }
        .msg-out { 
            align-self: flex-end; background: var(--wa-msg-out); 
            border-top-right-radius: 0; 
        }
        
        .time {
            font-size: 11px; color: rgba(255,255,255,0.6);
            float: right; margin-left: 10px; margin-top: 5px;
        }

        /* FOOTER */
        .footer {
            height: 62px; background: var(--wa-header); padding: 5px 10px;
            display: flex; align-items: center; gap: 10px; flex-shrink: 0;
        }
        .emoji-btn, .attach-btn { font-size: 24px; color: var(--text-secondary); cursor: pointer; padding: 5px; }
        .input-box {
            flex: 1; padding: 12px 15px; background: #2a3942; border: none;
            border-radius: 8px; color: white; font-size: 15px; outline: none;
        }
        .send-btn {
            background: var(--wa-green); width: 45px; height: 45px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; border: none;
            color: white; font-size: 20px; cursor: pointer;
        }

        /* Typing Indicator */
        .typing { font-size: 12px; color: var(--wa-green); margin-left: 5px; font-weight: bold; display: none; }

        @media (min-width: 768px) {
            body { max-width: 100%; background: #000; justify-content: center; align-items: center; }
            .app-wrapper { 
                width: 100%; max-width: 900px; height: 95vh; 
                display: flex; flex-direction: column; 
                box-shadow: 0 0 20px rgba(0,0,0,0.5); 
            }
        }
    </style>
</head>
<body>

<div class="app-wrapper" style="width:100%; height:100%; display:flex; flex-direction:column;">
    
    <div class="header">
        <div class="back-btn">‚Üê</div>
        <img src="images.jpg" onerror="this.src='https://api.dicebear.com/7.x/avataaars/svg?seed=Rahul'" class="avatar" alt="RK">
        <div class="info">
            <div class="name">
                Rahul Khanjire Sir
                <span class="verified-tick">‚úî</span>
            </div>
            <div class="status" id="statusText">Online</div>
        </div>
        <div class="header-icons">
            <span onclick="toggleSettings()">‚öôÔ∏è</span> 
            <span>üìû</span>
            <span>‚ãÆ</span>
        </div>
    </div>

    <div id="apiPanel">
        <label style="color:#aaa; font-size:12px;">GEMINI API KEY (Saved Locally)</label>
        <input type="password" id="apiKey" placeholder="Paste Key Here...">
        <button class="save-btn" onclick="saveKey()">CONNECT BOT</button>
    </div>

    <div class="chat-container" id="chatBox">
        <div class="msg msg-in">
            ‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞! ‡§Æ‡•Ä ‡§∞‡§æ‡§π‡•Å‡§≤ ‡§ñ‡§Ç‡§ú‡§ø‡§∞‡•á ‡§¨‡•ã‡§≤‡§§‡•ã‡§Ø. 
            ‡§Æ‡•Ä ‡§Ü‡§™‡§≤‡•ç‡§Ø‡§æ ‡§∏‡•á‡§µ‡•á‡§∏‡§æ‡§†‡•Ä ‡§á‡§•‡•á ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§Ü‡§π‡•á. ‡§Ü‡§™‡§≤‡•ç‡§Ø‡§æ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§¨‡§ø‡§®‡§ß‡§æ‡§∏‡•ç‡§§ ‡§Æ‡§æ‡§Ç‡§°‡§æ.
            <span class="time">Now</span>
        </div>
    </div>

    <div class="footer">
        <div class="emoji-btn">üòä</div>
        <div class="attach-btn">üìé</div>
        <input type="text" id="userInput" class="input-box" placeholder="Message" onkeypress="handleEnter(event)">
        <button class="send-btn" onclick="sendMessage()">‚û§</button>
    </div>

</div>

<script>
    // --- Logic Configuration ---
    const SYSTEM_PROMPT = `
    ACT AS: Rahul Khanjire (Respected political leader/social worker from Ichalkaranji/Kolhapur region).
    LANGUAGE: STRICTLY MARATHI (Devanagari script preferred, but simple conversational Marathi).
    TONE: Polite, authoritative, caring, and solution-oriented. Like a leader talking to a citizen.
    CONTEXT: You are replying to citizens on WhatsApp.
    
    RULES:
    1. Reply ONLY in Marathi.
    2. Be respectful (Use 'Namaskar', 'Mitra', 'Dada', 'Tai').
    3. Keep answers concise (WhatsApp style).
    4. If asked about helping, say you are always ready for public service.
    5. Never mention you are an AI. Stay in character as Rahul Khanjire.
    `;

    // --- Core Functions ---

    window.onload = () => {
        const savedKey = localStorage.getItem('rahul_bot_key');
        if (savedKey) document.getElementById('apiKey').value = savedKey;
    };

    function toggleSettings() {
        document.getElementById('apiPanel').classList.toggle('active');
    }

    function saveKey() {
        const key = document.getElementById('apiKey').value.trim();
        if (key) {
            localStorage.setItem('rahul_bot_key', key);
            toggleSettings();
            alert("Bot Connected Successfully! (Key Saved)");
        }
    }

    function handleEnter(e) {
        if (e.key === 'Enter') sendMessage();
    }

    function getTime() {
        return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }

    function addMessage(text, type) {
        const box = document.getElementById('chatBox');
        const div = document.createElement('div');
        div.className = `msg ${type}`;
        div.innerHTML = `${text} <span class="time">${getTime()}</span>`;
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
    }

    async function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        const key = localStorage.getItem('rahul_bot_key');

        if (!text) return;
        
        if (!key) {
            alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§•‡§Æ ‡§ó‡§ø‡§Ø‡§∞ ‡§Ü‡§Ø‡§ï‡•â‡§® (‚öôÔ∏è) ‡§µ‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•Ç‡§® API Key ‡§ü‡§æ‡§ï‡§æ.");
            return;
        }

        // 1. User Message
        addMessage(text, 'msg-out');
        input.value = '';

        // 2. Simulate Typing
        document.getElementById('statusText').innerText = "typing...";
        document.getElementById('statusText').style.color = "#00a884";

        try {
            // 3. API Call (Direct to Gemini Flash-Lite)
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent?key=${key}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [
                        { role: "user", parts: [{ text: SYSTEM_PROMPT + "\n\nUser says: " + text }] }
                    ]
                })
            });

            const data = await response.json();
            
            // 4. Bot Response
            if (data.candidates && data.candidates[0].content) {
                const reply = data.candidates[0].content.parts[0].text;
                addMessage(reply, 'msg-in');
            } else {
                addMessage("Server error. Please try again.", 'msg-in');
            }

        } catch (error) {
            addMessage("Network Error. Check internet or API Key.", 'msg-in');
        } finally {
            document.getElementById('statusText').innerText = "Online";
            document.getElementById('statusText').style.color = "#8696a0";
        }
    }
</script>

</body>
</html>
